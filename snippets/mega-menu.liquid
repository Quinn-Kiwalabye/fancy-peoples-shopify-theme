<div class="mega-menu-wrapper js-mega-menu" aria-hidden="true">
  <div class="mega-menu">
    <div class="mega-menu__header">
      <button type="button" class="mega-menu__close js-close-mega-menu">
        <span class="icon">✕</span>
      </button>
      <a href="#" class="mega-menu__back-button js-mega-menu-back">
        <span class="icon">←</span>
        BACK
      </a>
    </div>
    
    <div class="mega-menu__content">
      <div class="mega-menu__primary">
        <ul class="mega-menu__primary-list">
          <li class="mega-menu__item">
            <a href="{{ routes.collections_url }}/women" class="mega-menu__link js-mega-menu-trigger" data-target="women">Women</a>
          </li>
          <li class="mega-menu__item">
            <a href="{{ routes.collections_url }}/men" class="mega-menu__link js-mega-menu-trigger" data-target="men">Men</a>
          </li>
          <li class="mega-menu__item">
            <a href="{{ routes.collections_url }}/bags" class="mega-menu__link js-mega-menu-trigger" data-target="bags">Bags</a>
          </li>
          <li class="mega-menu__item">
            <a href="{{ routes.collections_url }}/jewelry" class="mega-menu__link js-mega-menu-trigger" data-target="jewelry">Jewelry</a>
          </li>
          <li class="mega-menu__item">
            <a href="{{ routes.collections_url }}/beauty" class="mega-menu__link">Beauty</a>
          </li>
          <li class="mega-menu__item">
            <a href="/pages/about-us" class="mega-menu__link">About</a>
          </li>
        </ul>
      </div>
      
      <div class="mega-menu__secondary mega-menu__secondary--women js-mega-menu-panel" data-panel="women">
        <h2 class="mega-menu__title">Women</h2>
        <ul class="mega-menu__secondary-list">
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/women-new-arrivals" class="mega-menu__secondary-link">New in Women</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/handbags" class="mega-menu__secondary-link">Handbags</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/women-clothing" class="mega-menu__secondary-link">Clothing</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/women-shoes" class="mega-menu__secondary-link">Shoes</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/women-purses-accessories" class="mega-menu__secondary-link">Purses & Small Accessories</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/women-travel" class="mega-menu__secondary-link">Travel</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/women-accessories" class="mega-menu__secondary-link">Accessories</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/women-jewelry-watches" class="mega-menu__secondary-link">Jewellery & Watches</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/women-gifts" class="mega-menu__secondary-link">Gifts</a>
          </li>
        </ul>
      </div>
      
      <div class="mega-menu__secondary mega-menu__secondary--men js-mega-menu-panel" data-panel="men">
        <h2 class="mega-menu__title">Men</h2>
        <ul class="mega-menu__secondary-list">
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/men-new-arrivals" class="mega-menu__secondary-link">New in Men</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/men-bags" class="mega-menu__secondary-link">Bags</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/men-clothing" class="mega-menu__secondary-link">Clothing</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/men-shoes" class="mega-menu__secondary-link">Shoes</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/men-accessories" class="mega-menu__secondary-link">Accessories</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/men-watches" class="mega-menu__secondary-link">Watches</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/men-gifts" class="mega-menu__secondary-link">Gifts</a>
          </li>
        </ul>
      </div>
      
      <div class="mega-menu__secondary mega-menu__secondary--bags js-mega-menu-panel" data-panel="bags">
        <h2 class="mega-menu__title">Bags</h2>
        <ul class="mega-menu__secondary-list">
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/new-bags" class="mega-menu__secondary-link">New Bags</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/crossbody-bags" class="mega-menu__secondary-link">Crossbody Bags</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/tote-bags" class="mega-menu__secondary-link">Tote Bags</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/shoulder-bags" class="mega-menu__secondary-link">Shoulder Bags</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/top-handle-bags" class="mega-menu__secondary-link">Top Handle Bags</a>
          </li>
        </ul>
      </div>
      
      <div class="mega-menu__secondary mega-menu__secondary--jewelry js-mega-menu-panel" data-panel="jewelry">
        <h2 class="mega-menu__title">Jewelry</h2>
        <ul class="mega-menu__secondary-list">
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/new-jewelry" class="mega-menu__secondary-link">New Jewelry</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/necklaces" class="mega-menu__secondary-link">Necklaces</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/earrings" class="mega-menu__secondary-link">Earrings</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/bracelets" class="mega-menu__secondary-link">Bracelets</a>
          </li>
          <li class="mega-menu__secondary-item">
            <a href="{{ routes.collections_url }}/rings" class="mega-menu__secondary-link">Rings</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

<style>
.mega-menu-wrapper {
  position: fixed;
  top: 0;
  right: -100%;
  width: 100%;
  height: 100vh;
  background-color: rgba(0, 0, 0, 0.5);
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s, visibility 0.3s;
  display: flex;
  justify-content: flex-end;
}

.mega-menu-wrapper.is-active {
  right: 0;
  opacity: 1;
  visibility: visible;
}

.mega-menu {
  width: 420px;
  max-width: 100%;
  height: 100%;
  background-color: white;
  overflow-y: auto;
  transform: translateX(100%);
  transition: transform 0.3s;
}

.mega-menu-wrapper.is-active .mega-menu {
  transform: translateX(0);
}

.mega-menu__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px;
  border-bottom: 1px solid #eee;
}

.mega-menu__close,
.mega-menu__back-button {
  background: none;
  border: none;
  padding: 0;
  cursor: pointer;
  font-size: 14px;
  display: flex;
  align-items: center;
  text-decoration: none;
  color: #000;
}

.mega-menu__back-button {
  display: none;
}

.mega-menu__back-button.is-active {
  display: flex;
}

.mega-menu__content {
  position: relative;
  height: calc(100% - 61px);
}

.mega-menu__primary {
  padding: 20px;
}

.mega-menu__primary-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.mega-menu__item {
  margin-bottom: 20px;
}

.mega-menu__link {
  font-size: 18px;
  color: #000;
  text-decoration: none;
  font-weight: 400;
  letter-spacing: 0.5px;
}

.mega-menu__secondary {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: white;
  padding: 20px;
  transform: translateX(100%);
  transition: transform 0.3s;
  opacity: 0;
  visibility: hidden;
}

.mega-menu__secondary.is-active {
  transform: translateX(0);
  opacity: 1;
  visibility: visible;
}

.mega-menu__title {
  font-size: 24px;
  margin-bottom: 30px;
  font-weight: 400;
}

.mega-menu__secondary-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.mega-menu__secondary-item {
  margin-bottom: 15px;
}

.mega-menu__secondary-link {
  font-size: 16px;
  color: #000;
  text-decoration: none;
}

/* Icons */
.icon-account,
.icon-cart,
.icon-search,
.icon-close,
.icon-arrow-left {
  display: inline-block;
  width: 20px;
  height: 20px;
  vertical-align: middle;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  var megaMenuToggle = document.querySelector('.js-mobile-nav-toggle');
  var megaMenuWrapper = document.querySelector('.js-mega-menu');
  var megaMenuClose = document.querySelector('.js-close-mega-menu');
  var megaMenuTriggers = document.querySelectorAll('.js-mega-menu-trigger');
  var megaMenuBack = document.querySelector('.js-mega-menu-back');

  // Open mega menu
  megaMenuToggle.addEventListener('click', function() {
    megaMenuWrapper.classList.add('is-active');
    megaMenuToggle.setAttribute('aria-expanded', 'true');
    megaMenuWrapper.setAttribute('aria-hidden', 'false');
    document.body.style.overflow = 'hidden';
  });

  // Close mega menu
  megaMenuClose.addEventListener('click', function() {
    closeMegaMenu();
  });

  // Click outside to close
  megaMenuWrapper.addEventListener('click', function(e) {
    if (e.target === megaMenuWrapper) {
      closeMegaMenu();
    }
  });

  // Show secondary menu
  megaMenuTriggers.forEach(function(trigger) {
    trigger.addEventListener('click', function(e) {
      e.preventDefault();
      var target = this.getAttribute('data-target');
      var panel = document.querySelector('.js-mega-menu-panel[data-panel="' + target + '"]');
      
      if (panel) {
        panel.classList.add('is-active');
        megaMenuBack.classList.add('is-active');
      }
    });
  });

  // Back button
  megaMenuBack.addEventListener('click', function(e) {
    e.preventDefault();
    var activePanel = document.querySelector('.js-mega-menu-panel.is-active');
    
    if (activePanel) {
      activePanel.classList.remove('is-active');
      megaMenuBack.classList.remove('is-active');
    }
  });

  function closeMegaMenu() {
    megaMenuWrapper.classList.remove('is-active');
    megaMenuToggle.setAttribute('aria-expanded', 'false');
    megaMenuWrapper.setAttribute('aria-hidden', 'true');
    document.body.style.overflow = '';
    
    // Reset any active secondary panels
    var activePanels = document.querySelectorAll('.js-mega-menu-panel.is-active');
    activePanels.forEach(function(panel) {
      panel.classList.remove('is-active');
    });
    
    megaMenuBack.classList.remove('is-active');
  }
});
</script>